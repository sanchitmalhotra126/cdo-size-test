#!/usr/bin/env ruby
require_relative '../deployment'

def main()
  db = URI.parse CDO.dashboard_db_reader

  q = ARGV.join(' ').strip
  return if q.empty?

  command = [
    'mysql',
    "--user=#{db.user}",
    "--host=#{db.host}",
    "--database=#{db.path[1..-1]}",
    "--execute=\"#{q}\"",
  ]
  command << "--password=#{db.password}" unless db.password.nil?

  system(command.join(' '))
end

main

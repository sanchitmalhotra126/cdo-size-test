#!/usr/bin/env ruby

require_relative('../../dashboard/config/environment')
require 'cdo/contact_rollups_v2'
require 'cdo/contact_rollups_validation'
require 'cdo/pardot'
require 'cdo/chat_client'
require 'cdo/only_one'
require 'cdo/log_collector'
require 'honeybadger/ruby'

CHAT_CHANNEL = "cron-daily".freeze

def main
  log_collector = LogCollector.new "Build contact rollups"

  # Build new daily table of contact rollups
  ContactRollupsV2.build_contact_rollups(log_collector)
end

main if only_one_running?(__FILE__)

#!/usr/bin/env ruby
require_relative '../../../src/env'
require 'cdo/hip_chat'
require 'cdo/solr'

SOLR = CDO.solr_server ? Solr::Server.new(host:CDO.solr_server) : nil

def main()
  workshops = SOLR.query(q:"*:*", fq:["kind_s:ProfessionalDevelopmentWorkshop", "first_date_dt:[NOW/DAY+5DAY TO NOW/DAY+6DAY]"], sort:"id asc", rows:1000)
  workshops.each do |workshop|
    signups = SOLR.query(q:"*:*", fq:["kind_s:ProfessionalDevelopmentWorkshopSignup", "workshop_id_i:#{workshop['id']}", "-status_s:cancelled"], sort:"id asc", rows:1000)
    signups.each do |signup|
      send_reminder_email(signup)
    end
  end
end

def send_reminder_email(signup)
#   SEND REMINDER EMAIL
end

main if only_one_running?(__FILE__)

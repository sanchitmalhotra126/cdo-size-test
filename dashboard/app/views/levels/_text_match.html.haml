.text-match
  - data = @level.properties
  - app = 'text_match'

  .mainblock
    = render partial: 'levels/content', locals: {app: app, data: data}
    - height = data['height'] || '40'
    %textarea.response{placeholder: data['placeholder'] ? string_or_image(app, data['placeholder']) : t(app + '.placeholder'), style: "width: 700px; height: #{height}px;", readonly: @view_options.readonly_workspace}
    = render partial: 'levels/dialog', locals: {app: app, data: data}
    = render partial: 'levels/teacher_markdown', locals: {data: data}
  .clear

= render partial: 'levels/common_audio'

:javascript
  // Pre-fill text area with previous response content
  $('textarea.response').val(appOptions.level.lastAttempt);

  function getResult()
  {
    var response = $('textarea.response').val();
    var answers = appOptions.level.answers;
    if (answers) {
      response = response.replace(/\s+/g, '');
      var result = answers.some(function(element) {
        return response == element.replace(/\s+/g, '');
      });
      return {
        response: encodeURIComponent(response),
        result: result
      };
    } else {
      // Always succeed for any non-empty response to open-ended question without answer(s)
      return {
        response: encodeURIComponent(response),
        result: response.length > 0
      };
    }
  }

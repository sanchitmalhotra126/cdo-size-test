- if current_user
  - role_class = current_user.user_type

  #contents
    #welcome{class: role_class}
      = t('welcome_back', name: current_user.name)
      - if current_user.teacher?
        = link_to teacher_dashboard_url do
          %button.primary{class: 'teacherdashboard', style: "margin-left: 20px;"}= t('teacher.students.dashboard')
    - if Gatekeeper.allows('logged_in_studio_hero', default: true)
      - plc_enrollments = Plc::UserCourseEnrollment.where(user: current_user)
      - plc_enrollments.each do |course_enrollment|
        - uncompleted_units = course_enrollment.plc_unit_assignments.where.not(status: [Plc::EnrollmentUnitAssignment::COMPLETED, Plc::EnrollmentUnitAssignment::START_BLOCKED])
        - if uncompleted_units.any?
          - unit_enrollment = uncompleted_units.first
          #plc_course_progress{class: role_class}
            %h4
              = t('your_professional_learning_plan')
            .flex_container{style: 'display: flex'}
              .flex_item{style: 'width: 50%'}
                #{course_enrollment.plc_course.name}
              .flex_item{style: 'width: 50%'}
                = link_to CDO.studio_url(course_path(course_enrollment.plc_course.name.downcase.gsub(' ', '-'))) do
                  %button.primary{class: 'teacherdashboard', style: "margin-left: 20px;"}= t('see_your_learning_plan')
      #body{class: role_class}
        - script = current_user.primary_script
        - if script
          - script_level = current_user.next_unpassed_progression_level(script)
        - if script && script_level
          #currentprogress
            = t("data.script.name.#{current_user.primary_script.name}.title")
            %br
            .smalltext= script_level.stage.localized_title
          #coursebuttons
            = link_to build_script_level_url(script_level) do
              %button.primary= t('continue')
            = link_to script_url(current_user.primary_script) do
              %button.primary= t('home.view_course')
        - elsif current_user.all_advertised_scripts_completed?
          #suggestcourse.smalltext!= t('home.student_finished', online_link: link_to(t('home.online'), 'http://code.org/learn/beyond'), local_school_link: link_to(t('home.local_school'), 'http://code.org/learn/local'))
        - else
          - if current_page?(root_url)  # Already at studio.code.org
            #suggestcourse.smalltext= t('home.choose_next_course')
          - else
            #suggestcourse.smalltext= link_to t('home.no_primary_course'), root_url
    - else
      #body{class: "hero_disabled"}
        During Hour of Code, we will not be showing the personalized links to the courses you are currently working on.
        Due to high database load, students in Computer Science Principles can reach their courses here:
        %ul
          %li
            %a{href: script_path(Script.get_from_cache('csp1'))} Computer Science Principles Unit 1
          %li
            %a{href: script_path(Script.get_from_cache('csp2'))} Computer Science Principles Unit 2
          %li
            %a{href: script_path(Script.get_from_cache('csp3'))} Computer Science Principles Unit 3
          %li
            %a{href: script_path(Script.get_from_cache('csp4'))} Computer Science Principles Unit 4
          %li
            %a{href: script_path(Script.get_from_cache("csp5"))} Computer Science Principles Unit 5
          %li
            %a{href: script_path(Script.get_from_cache("csp6"))} Computer Science Principles Unit 6
        Teachers in Professional Learning Programs can reach the online content and supports here:
        %ul
          %li Computer Science Principles Online Professional Learning
          %ul
            %li
              %a{href: script_path(Script.get_from_cache('csp1-support'))} CSP unit 1
            %li
              %a{href: 'http://studio.code.org/s/csp2-support'} CSP unit 2
            %li
              %a{href: 'http://studio.code.org/s/csp3-support'} CSP unit 3
        %ul
          %li Exploring Computer Science Online Professional Learning
          %ul
            %li
              %a{href: script_path(Script.get_from_cache('ecs-unit1'))} Exploring Computer Science Unit 1
            %li
              %a{href: script_path(Script.get_from_cache('ecs-unit2'))} Exploring Computer Science Unit 2
            %li
              %a{href: script_path(Script.get_from_cache('ecs-unit3'))} Exploring Computer Science Unit 3
            %li
              %a{href: script_path(Script.get_from_cache('ecs-unit4'))} Exploring Computer Science Unit 4
        %ul
          %li Computer Science in Algebra Online Professional Learning
          %ul
            %li
              %a{href: script_path(Script.get_from_cache('algebraPD1'))} CS in Algebra Part 1
            %li
              %a{href: script_path(Script.get_from_cache('algebraPD2'))} CS in Algebra Part 2
        %ul
          %li Computer Science in Science Online Professional Learning
          %ul
            %li
              %a{href: script_path(Script.get_from_cache('sciencePD1'))} CS in Science Part 1
            %li
              %a{href: script_path(Script.get_from_cache('sciencePD2'))} CS in Science Part 2
            %li
              %a{href: script_path(Script.get_from_cache('sciencePD3'))} CS in Science Part 3
            %li
              %a{href: 'https://studio.code.org/s/sciencePD4'} CS in Science Part 4
        %ul
          %li Computer Science Fundamentals Online Professional Learning
  #clearboth{ style: 'clear:both;' }

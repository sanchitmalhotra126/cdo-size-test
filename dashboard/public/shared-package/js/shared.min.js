!function e(t,n,o){function a(r,p){if(!n[r]){if(!t[r]){var s="function"==typeof require&&require;if(!p&&s)return s(r,!0);if(i)return i(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[r]={exports:{}};t[r][0].call(c.exports,function(e){var n=t[r][1][e];return a(n?n:e)},c,c.exports,e,t,n,o)}return n[r].exports}for(var i="function"==typeof require&&require,r=0;r<o.length;r++)a(o[r]);return a}({1:[function(e,t,n){function o(e){var t=$(e).attr("clip-path");return t?t.match(/\(\#(.*)\)/)[1]:void 0}function a(e,t){var n=$('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" />');t&&n.attr("class",t);var a=o(e),i=$("#"+a);i.insertAfter(e).add(e).wrapAll(n)}function i(){var e,t=$("#visualization>svg")[0];if(t){var n={},i={},r=new WebKitMutationObserver(function(t){t.forEach(function(t){for(e=0;e<t.addedNodes.length;e++){var o=t.addedNodes[e];"image"==o.nodeName&&(n[$(o).attr("id")]=o),"clipPath"==o.nodeName&&(i[$(o).attr("id")]=o)}for(e=0;e<t.removedNodes.length;e++){var a=t.removedNodes[e];("image"==a.nodeName||"clipPath"==a.nodeName)&&$("svg > svg:empty").remove()}}),$.each(n,function(e,t){var r=o(t);i.hasOwnProperty(r)&&(a(t),delete n[e],delete i[r])})});r.observe(t,{childList:!0})}}function r(){$("[clip-path]").each(function(e,t){$(t).attr("class")===p?($(t).attr("class",""),a(t,p)):a(t)})}var p="pegman-location";t.exports={fixup:function(){r(),i()}}},{}],2:[function(e,t,n){var o={api_base_url:"/v3/channels",all:function(e){$.ajax({url:this.api_base_url,type:"get",dataType:"json"}).done(function(t,n){e(null,t)}).fail(function(t,n,o){var a=new Error("status: "+n+"; error: "+o);e(a,null)})},create:function(e,t){$.ajax({url:this.api_base_url,type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify(e)}).done(function(e,n){t(null,e)}).fail(function(e,n,o){var a=new Error("status: "+n+"; error: "+o);t(a,void 0)})},"delete":function(e,t){$.ajax({url:this.api_base_url+"/"+e+"/delete",type:"post",dataType:"json"}).done(function(e,n){t(null,!0)}).fail(function(e,n,o){var a=new Error("status: "+n+"; error: "+o);t(a,!1)})},fetch:function(e,t){$.ajax({url:this.api_base_url+"/"+e,type:"get",dataType:"json"}).done(function(e,n){t(null,e)}).fail(function(e,n,o){var a=new Error("status: "+n+"; error: "+o);t(a,void 0)})},update:function(e,t,n){$.ajax({url:this.api_base_url+"/"+e,type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify(t)}).done(function(e,t){n(null,e)}).fail(function(e,t,o){var a=new Error("status: "+t+"; error: "+o);n(a,!1)})},copyAll:function(e,t,n){$.ajax({url:this.api_base_url+"/"+t+"?src="+e,type:"put"}).done(function(e,t){n(null,e)}).fail(function(e,t,o){var a=new Error("status: "+t+"; error: "+o);n(a,!1)})}};t.exports={create:function(e){return $.extend({},o,{api_base_url:e})}}},{}],3:[function(e,t,n){function o(e){return(window.digestManifest||{})[e]||e}function a(e,t){return function(){var n=new $.Deferred,a=t?"?"+Math.random():"";return document.body.appendChild($("<script>",{src:appOptions.baseUrl+o("js/"+e+".js")+a}).on("load",function(){n.resolve()})[0]),n}}function i(e){$("body").append($("<link>",{rel:"stylesheet",type:"text/css",href:appOptions.baseUrl+"css/"+e+".css"}))}t.exports=function(e){i("common"),i(appOptions.app);var t=a("manifest",!0)();appOptions.droplet?(i("droplet/droplet.min"),i("tooltipster/tooltipster.min"),t=t.then(a("jsinterpreter/acorn_interpreter")).then(a("marked/marked")).then(a("ace/ace")).then(a("ace/mode-javascript")).then(a("ace/ext-language_tools")).then(a("droplet/droplet-full")).then(a("tooltipster/jquery.tooltipster"))):t=t.then(a("blockly")).then(a("marked/marked")).then(a(appOptions.locale+"/blockly_locale")),window.dashboard&&dashboard.project&&(t=t.then(dashboard.project.load)),t.then(a("common"+appOptions.pretty)).then(a(appOptions.locale+"/common_locale")).then(a(appOptions.locale+"/"+appOptions.app+"_locale")).then(a(appOptions.app+appOptions.pretty)).then(e)}},{}],4:[function(e,t,n){function o(e,t){"function"==typeof e&&e(t)}function a(){var e;return e=window.Blockly?Blockly.readOnly?c.levelSource:Blockly.Xml.domToText(Blockly.Xml.blockSpaceToDom(Blockly.mainBlockSpace)):window.Applab&&Applab.getCode()}function i(){return window.Applab&&Applab.getHtml()}function r(){var e=l();if(e.action){var t;return"view"===e.action&&c&&c.isOwner?(t=location.href.replace(/\/view$/,"/edit"),appOptions.readonlyWorkspace=!1):"edit"!==e.action||c&&c.isOwner||(t=location.href.replace(/\/edit$/,"/view"),appOptions.readonlyWorkspace=!0),t&&t!==location.href?s(t,!0):!1}}function p(){var e=location.href.replace("#","/");if(e===location.href)return!1;l();return s(e,!1)}function s(e,t){return t&&window.history.pushState?(window.history.pushState({modified:!0},document.title,e),!1):(location.href=e,!0)}function l(){var e=location.pathname;return location.hash&&(e+=location.hash.replace("#","/")),"p"!==e.split("/")[m.PROJECTS]&&"projects"!==e.split("/")[m.PROJECTS]?{appName:null,channelId:null,action:null}:{appName:e.split("/")[m.APP],channelId:e.split("/")[m.CHANNEL_ID],action:e.split("/")[m.ACTION]}}var c,d=3e4,u=!1,f=e("./clientApi").create("/v3/assets"),h=e("./clientApi").create("/v3/channels"),v={appModeChanged:"appModeChanged",appInitialized:"appInitialized",workspaceChange:"workspaceChange"},m={START:0,PROJECTS:1,APP:2,CHANNEL_ID:3,ACTION:4},w=!1,g=t.exports={getCurrentId:function(){return c?c.id:void 0},getCurrentName:function(){return c?c.name:void 0},getCurrentTimestamp:function(){return c?c.updatedAt:void 0},isEditing:function(){return w},init:function(){p()||r()||(appOptions.level.isProjectLevel||c?(c&&c.levelHtml&&(appOptions.level.levelHtml=c.levelHtml),w?(c?c.levelSource&&(appOptions.level.lastAttempt=c.levelSource):c={name:"My Project"},$(window).on(v.appModeChanged,function(e,t){this.save(t)}.bind(this)),$(window).on(v.appInitialized,function(){c.levelSource=a()}.bind(this)),$(window).on(v.workspaceChange,function(){u=!0}),window.setInterval(this.autosave_.bind(this),d),c.hidden||(c.isOwner||!l().channelId?dashboard.header.showProjectHeader():dashboard.header.showMinimalProjectHeader())):c&&(appOptions.level.lastAttempt=c.levelSource,dashboard.header.showMinimalProjectHeader())):appOptions.isLegacyShare&&this.appToProjectUrl()&&(c={name:"Untitled Project"},dashboard.header.showMinimalProjectHeader()),appOptions.noPadding&&$(".full_container").css({padding:"0px"}))},appToProjectUrl:function(){switch(appOptions.app){case"applab":return"/projects/applab";case"turtle":return"/projects/artist";case"calc":return"/projects/calc";case"eval":return"/projects/eval";case"studio":return appOptions.level.useContractEditor?"/projects/algebra_game":"/projects/playlab"}},save:function(e,t){1===arguments.length&&(t=arguments[0],e=a()),$(".project_updated_at").text("Saving...");var n=c.id;c.levelSource=e,c.levelHtml=i(),c.level=this.appToProjectUrl(),n&&c.isOwner?h.update(n,c,function(e,n){this.updateCurrentData_(e,n,!1),o(t,n)}.bind(this)):h.create(c,function(e,n){this.updateCurrentData_(e,n,!0),o(t,n)}.bind(this))},updateCurrentData_:function(e,t,n){return e?void $(".project_updated_at").text("Error saving project"):(c=t,n&&(w&&l().appName?location.hash||!window.history.pushState?location.href=c.level+"#"+c.id+"/edit":window.history.pushState(null,document.title,this.getPathName("edit")):location.href=this.getPathName("edit")),void dashboard.header.updateTimestamp())},autosave_:function(){if(void 0!==c.levelSource&&(appOptions.droplet||u)){var e=a(),t=i();return c.levelSource===e&&c.levelHtml===t?void(u=!1):void this.save(e,function(){u=!1})}},rename:function(e,t){c.name=e,this.save(t)},copy:function(e,t){var n=c.id,o=this.copyAssets.bind(this,n,t);delete c.id,delete c.hidden,c.name=e,this.save(o)},copyAssets:function(e,t){if(!e)return void o(t);var n=c.id;f.copyAll(e,n,function(e){return e?void $(".project_updated_at").text("Error copying files"):void o(t)})},serverSideRemix:function(){location.href=g.getPathName("remix")},"delete":function(e){var t=c.id;t?h["delete"](t,function(t,n){o(e,n)}):o(e,!1)},load:function(){var e;if(appOptions.level.isProjectLevel){if(p()||r())return;var t=l();if(t.channelId)return"edit"===t.action?w=!0:$("#betainfo").hide(),e=new $.Deferred,h.fetch(t.channelId,function(n,o){n?location.href=location.pathname.split("/").slice(m.START,m.APP+1).join("/"):(c=o,c.isOwner&&"view"===t.action&&(w=!0),e.resolve())}),e;w=!0}else if(appOptions.level.projectTemplateLevelName||"applab"===appOptions.app)return w=!0,e=new $.Deferred,h.fetch(appOptions.channel,function(t,n){t?e.reject():(c=n,dashboard.header.showProjectLevelHeader(),e.resolve())}),e},getPathName:function(e){var t=this.appToProjectUrl()+"/"+this.getCurrentId();return e&&(t+="/"+e),t}}},{"./clientApi":2}],5:[function(e,t,n){var o={};t.exports={startTiming:function(e,t,n){var a=e+t+n;o[a]=(new Date).getTime()},stopTiming:function(e,t,n){var a=e+t+n,i=(new Date).getTime(),r=o[a],p=i-r;ga("send","timing",e,t,p,n)}}},{}],6:[function(require,module,exports){var timing=require("./timing"),chrome34Fix=require("./chrome34Fix"),loadApp=require("./loadApp"),project=require("./project");window.apps={load:loadApp,setup:function(){if(!window.dashboard)throw new Error("Assume existence of window.dashboard");dashboard.project=project,timing.startTiming("Puzzle",script_path,"");var baseOptions={containerId:"codeApp",Dialog:Dialog,cdoSounds:CDOSounds,position:{blockYCoordinateInterval:25},onInitialize:function(){dashboard.createCallouts(this.callouts),window.dashboard.isChrome34&&chrome34Fix.fixup(),appOptions.level.projectTemplateLevelName&&$("#clear-puzzle-header").hide(),$(document).trigger("appInitialized")},onAttempt:function(e){appOptions.level.isProjectLevel||(appOptions.channel&&(delete e.program,delete e.image),e.fallbackResponse=appOptions.report.fallback_response,e.callback=appOptions.report.callback,trackEvent("Puzzle","Attempt",script_path,e.pass?1:0),e.pass&&(trackEvent("Puzzle","Success",script_path,e.attempt),timing.stopTiming("Puzzle",script_path,"")),trackEvent("Activity","Lines of Code",script_path,e.lines),sendReport(e))},onResetPressed:function(){cancelReport()},onContinue:function(){lastServerResponse.videoInfo?showVideoDialog(lastServerResponse.videoInfo):lastServerResponse.nextRedirect&&(window.location.href=lastServerResponse.nextRedirect)},backToPreviousLevel:function(){lastServerResponse.previousLevelRedirect&&(window.location.href=lastServerResponse.previousLevelRedirect)},showInstructionsWrapper:function(e){if(!this.share&&!appOptions.level.skipInstructionsPopup){var t=!!appOptions.autoplayVideo,n=!(!appOptions.level.instructions&&!appOptions.level.aniGifURL);t?(showVideoDialog(appOptions.autoplayVideo),n&&$(".video-modal").on("hidden.bs.modal",function(){e()})):n&&e()}}};$.extend(!0,appOptions,baseOptions),function fixUpFunctions(node){if("object"==typeof node)for(var i in node)if(/^fn_/.test(i))try{node[i.replace(/^fn_/,"")]=eval("("+node[i]+")")}catch(e){}else fixUpFunctions(node[i])}(appOptions.level)},init:function(){dashboard.project.init(),window[appOptions.app+"Main"](appOptions)}}},{"./chrome34Fix":1,"./loadApp":3,"./project":4,"./timing":5}]},{},[6]);
!function e(t,o,n){function a(r,p){if(!o[r]){if(!t[r]){var s="function"==typeof require&&require;if(!p&&s)return s(r,!0);if(i)return i(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var c=o[r]={exports:{}};t[r][0].call(c.exports,function(e){var o=t[r][1][e];return a(o?o:e)},c,c.exports,e,t,o,n)}return o[r].exports}for(var i="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}({1:[function(e,t,o){function n(e){var t=$(e).attr("clip-path");return t?t.match(/\(\#(.*)\)/)[1]:void 0}function a(e,t){var o=$('<svg xmlns="http://www.w3.org/2000/svg" version="1.1" />');t&&o.attr("class",t);var a=n(e),i=$("#"+a);i.insertAfter(e).add(e).wrapAll(o)}function i(){var e,t=$("#visualization>svg")[0];if(t){var o={},i={},r=new WebKitMutationObserver(function(t){t.forEach(function(t){for(e=0;e<t.addedNodes.length;e++){var n=t.addedNodes[e];"image"==n.nodeName&&(o[$(n).attr("id")]=n),"clipPath"==n.nodeName&&(i[$(n).attr("id")]=n)}for(e=0;e<t.removedNodes.length;e++){var a=t.removedNodes[e];("image"==a.nodeName||"clipPath"==a.nodeName)&&$("svg > svg:empty").remove()}}),$.each(o,function(e,t){var r=n(t);i.hasOwnProperty(r)&&(a(t),delete o[e],delete i[r])})});r.observe(t,{childList:!0})}}function r(){$("[clip-path]").each(function(e,t){$(t).attr("class")===p?($(t).attr("class",""),a(t,p)):a(t)})}var p="pegman-location";t.exports={fixup:function(){r(),i()}}},{}],2:[function(e,t,o){var n={api_base_url:"/v3/channels",all:function(e){$.ajax({url:this.api_base_url,type:"get",dataType:"json"}).done(function(t,o){e(null,t)}).fail(function(t,o,n){var a=new Error("status: "+o+"; error: "+n);e(a,null)})},create:function(e,t){$.ajax({url:this.api_base_url,type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify(e)}).done(function(e,o){t(null,e)}).fail(function(e,o,n){var a=new Error("status: "+o+"; error: "+n);t(a,void 0)})},"delete":function(e,t){$.ajax({url:this.api_base_url+"/"+e+"/delete",type:"post",dataType:"json"}).done(function(e,o){t(null,!0)}).fail(function(e,o,n){var a=new Error("status: "+o+"; error: "+n);t(a,!1)})},fetch:function(e,t){$.ajax({url:this.api_base_url+"/"+e,type:"get",dataType:"json"}).done(function(e,o){t(null,e)}).fail(function(e,o,n){var a=new Error("status: "+o+"; error: "+n);t(a,void 0)})},update:function(e,t,o){$.ajax({url:this.api_base_url+"/"+e,type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify(t)}).done(function(e,t){o(null,e)}).fail(function(e,t,n){var a=new Error("status: "+t+"; error: "+n);o(a,!1)})}};t.exports={create:function(e){return $.extend({},n,{api_base_url:e})}}},{}],3:[function(e,t,o){function n(e,t){"function"==typeof e&&e(t)}function a(){var e=!1,t=location.hash.slice(1);if(t){var o=t.split("/");o.length>1&&"edit"==o[1]&&(t=o[0],e=!0)}return{channelId:t,isEditingProject:e}}function i(e){appOptions.readonlyWorkspace=!0,appOptions.callouts=[],appOptions.share=!0,appOptions.hideSource=e,appOptions.noPadding=r()}function r(){switch(appOptions.app){case"applab":case"flappy":case"studio":case"bounce":return appOptions.isMobile&&appOptions.hideSource;default:return!1}}var p,s=3e4,l=!1,c=e("./clientApi").create("/v3/channels"),d={appModeChanged:"appModeChanged",appInitialized:"appInitialized",workspaceChange:"workspaceChange",hashchange:"hashchange"},u=!1;t.exports={getCurrentId:function(){return p?p.id:void 0},getCurrentName:function(){return p?p.name:void 0},isEditing:function(){return u},init:function(){appOptions.level.isProjectLevel||p?($(window).on(d.hashchange,function(){var e=a();(p&&e.channelId!==p.id||e.isEditingProject!==u)&&location.reload()}.bind(this)),p&&p.levelHtml&&(appOptions.level.levelHtml=p.levelHtml),u?(p?p.levelSource&&(appOptions.level.lastAttempt=p.levelSource):p={name:"My Project"},$(window).on(d.appModeChanged,function(e,t){this.save(dashboard.getEditorSource(),t)}.bind(this)),$(window).on(d.appInitialized,function(){p.levelSource=dashboard.getEditorSource()}.bind(this)),$(window).on(d.workspaceChange,function(){l=!0}),window.setInterval(this.autosave_.bind(this),s),p.hidden||(p.isOwner||""===location.hash?dashboard.header.showProjectHeader():(dashboard.header.showMinimalProjectHeader(),i(!1)))):p&&p.levelSource&&(appOptions.level.lastAttempt=p.levelSource,dashboard.header.showMinimalProjectHeader(),i(!0))):appOptions.isLegacyShare&&this.appToProjectUrl()&&(p={name:"Untitled Project"},dashboard.header.showMinimalProjectHeader()),appOptions.noPadding&&$(".full_container").css({padding:"0px"})},updateTimestamp:function(){p.updatedAt?($(".project_updated_at").empty().append("Saved ").append($('<span class="timestamp">').attr("title",p.updatedAt)).show(),$(".project_updated_at span.timestamp").timeago()):$(".project_updated_at").text("Not saved")},appToProjectUrl:function(){switch(appOptions.app){case"applab":return"/p/applab";case"turtle":return"/p/artist";case"studio":return appOptions.level.useContractEditor?"/p/algebra_game":"/p/playlab"}},save:function(e,t){$(".project_updated_at").text("Saving...");var o=p.id;p.levelSource=e,p.levelHtml=window.Applab&&Applab.getHtml(),p.level=this.appToProjectUrl(),o&&p.isOwner?c.update(o,p,function(e,o){this.updateCurrentData_(e,o,!1),n(t,o)}.bind(this)):c.create(p,function(e,o){this.updateCurrentData_(e,o,!0),n(t,o)}.bind(this))},updateCurrentData_:function(e,t,o){return e?void $(".project_updated_at").text("Error saving project"):(p=t,o&&(location.href=p.level+"#"+p.id+"/edit"),void this.updateTimestamp())},autosave_:function(){if(void 0!==p.levelSource&&(appOptions.droplet||l)){var e=dashboard.getEditorSource();return p.levelSource===e?void(l=!1):void this.save(e,function(){l=!1})}},rename:function(e,t){p.name=e,this.save(dashboard.getEditorSource(),t)},copy:function(e,t){delete p.id,delete p.hidden,p.name=e,this.save(dashboard.getEditorSource(),t)},"delete":function(e){var t=p.id;t?c["delete"](t,function(t,o){n(e,o)}):n(e,!1)},load:function(){var e;if(appOptions.level.isProjectLevel){var t=a();if(t.channelId)return t.isEditingProject?u=!0:$("#betainfo").hide(),e=new $.Deferred,c.fetch(t.channelId,function(t,o){t?location.href=location.pathname:(p=o,e.resolve())}),e;u=!0}else if(appOptions.level.projectTemplateLevelName||"applab"===appOptions.app)return u=!0,e=new $.Deferred,c.fetch(appOptions.channel,function(t,o){t?e.reject():(p=o,dashboard.header.showProjectLevelHeader(),e.resolve())}),e}}},{"./clientApi":2}],4:[function(e,t,o){var n={};t.exports={startTiming:function(e,t,o){var a=e+t+o;n[a]=(new Date).getTime()},stopTiming:function(e,t,o){var a=e+t+o,i=(new Date).getTime(),r=n[a],p=i-r;ga("send","timing",e,t,p,o)}}},{}],5:[function(require,module,exports){function initApp(){dashboard.project.init(),window[appOptions.app+"Main"](appOptions)}function loadSource(e){return function(){var t=new $.Deferred;return document.body.appendChild($("<script>",{src:appOptions.baseUrl+"js/"+e+".js"}).on("load",function(){t.resolve()})[0]),t}}function loadStyle(e){$("body").append($("<link>",{rel:"stylesheet",type:"text/css",href:appOptions.baseUrl+"css/"+e+".css"}))}var timing=require("./timing"),chrome34Fix=require("./chrome34Fix");if(dashboard.project=require("./project"),!window.dashboard)throw new Error("Assume existence of window.dashboard");timing.startTiming("Puzzle",script_path,"");var baseOptions={containerId:"codeApp",Dialog:Dialog,cdoSounds:CDOSounds,position:{blockYCoordinateInterval:25},onInitialize:function(){dashboard.createCallouts(this.callouts),window.dashboard.isChrome34&&chrome34Fix.fixup(),$(document).trigger("appInitialized")},onAttempt:function(e){appOptions.level.isProjectLevel||(appOptions.channel&&(delete e.program,delete e.image),e.fallbackResponse=appOptions.report.fallback_response,e.callback=appOptions.report.callback,trackEvent("Puzzle","Attempt",script_path,e.pass?1:0),e.pass&&(trackEvent("Puzzle","Success",script_path,e.attempt),timing.stopTiming("Puzzle",script_path,"")),trackEvent("Activity","Lines of Code",script_path,e.lines),sendReport(e))},onResetPressed:function(){cancelReport()},onContinue:function(){lastServerResponse.videoInfo?showVideoDialog(lastServerResponse.videoInfo):lastServerResponse.nextRedirect&&(window.location.href=lastServerResponse.nextRedirect)},backToPreviousLevel:function(){lastServerResponse.previousLevelRedirect&&(window.location.href=lastServerResponse.previousLevelRedirect)},showInstructionsWrapper:function(e){if(!this.share&&!appOptions.level.skipInstructionsPopup){var t=!!appOptions.autoplayVideo,o=!(!appOptions.level.instructions&&!appOptions.level.aniGifURL);t?(showVideoDialog(appOptions.autoplayVideo),o&&$(".video-modal").on("hidden.bs.modal",function(){e()})):o&&e()}}};$.extend(!0,appOptions,baseOptions),function fixUpFunctions(node){if("object"==typeof node)for(var i in node)if(/^fn_/.test(i))try{node[i.replace(/^fn_/,"")]=eval("("+node[i]+")")}catch(e){}else fixUpFunctions(node[i])}(appOptions.level),dashboard.getEditorSource=function(){return window.Blockly?Blockly.Xml.domToText(Blockly.Xml.blockSpaceToDom(Blockly.mainBlockSpace)):window.Applab&&Applab.getCode()},loadStyle("common"),loadStyle(appOptions.app);var promise;appOptions.droplet?(loadStyle("droplet/droplet.min"),loadStyle("tooltipster/tooltipster.min"),promise=loadSource("jsinterpreter/acorn_interpreter")().then(loadSource("marked/marked")).then(loadSource("ace/ace")).then(loadSource("ace/mode-javascript")).then(loadSource("ace/ext-language_tools")).then(loadSource("droplet/droplet-full")).then(loadSource("tooltipster/jquery.tooltipster")).then(dashboard.project.load)):promise=loadSource("blockly")().then(loadSource("marked/marked")).then(loadSource(appOptions.locale+"/blockly_locale")).then(dashboard.project.load),promise=promise.then(loadSource("common"+appOptions.pretty)).then(loadSource(appOptions.locale+"/common_locale")).then(loadSource(appOptions.locale+"/"+appOptions.app+"_locale")).then(loadSource(appOptions.app+appOptions.pretty)).then(initApp)},{"./chrome34Fix":1,"./project":3,"./timing":4}]},{},[5]);
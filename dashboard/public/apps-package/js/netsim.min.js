require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({128:[function(a){var b=a("../appMain"),c=a("../StudioApp").singleton,d=a("./netsim"),e=a("./levels"),f=a("./skins");window.netsimMain=function(a){a.skinsModule=f,a.isEditorless=!0;var g=new d;g.injectStudioApp(c),b(g,e,a)}},{"../StudioApp":2,"../appMain":3,"./levels":127,"./netsim":129,"./skins":132}],132:[function(a,b,c){var d=a("../skins");c.load=function(a,b){var c=d.load(a,b);return c}},{"../skins":135}],129:[function(a,b){"use strict";var c=a("./page.html"),d=a("./NetSimConnection"),e=a("./DashboardUser"),f=a("./NetSimLobby"),g=a("./NetSimRouterPanel"),h=a("./RunLoop"),i=function(){this.skin=null,this.level=null,this.heading=0,this.currentUser_=e.getCurrentUser(),this.connection_=null,this.runLoop_=new h};b.exports=i,i.prototype.injectStudioApp=function(a){this.studioApp_=a},i.prototype.attachHandlers_=function(){},i.prototype.init=function(b){if(!this.studioApp_)throw new Error("NetSim requires a StudioApp");this.skin=b.skin,this.level=b.level,b.html=c({assetUrl:this.studioApp_.assetUrl,data:{visualization:"",localeDirection:this.studioApp_.localeDirection(),controls:a("./controls.html")({assetUrl:this.studioApp_.assetUrl})},hideRunButton:!0}),b.enableShowCode=!1,b.loadAudio=this.loadAudio_.bind(this),this.studioApp_.configureDom=this.configureDomOverride_.bind(this.studioApp_),this.studioApp_.onResize=this.onResizeOverride_.bind(this.studioApp_),this.studioApp_.init(b),this.attachHandlers_(),this.currentUser_.whenReady(function(){var a=this.currentUser_.name+"_"+(Math.floor(99*Math.random())+1);this.initWithUserName_(a)}.bind(this)),this.runLoop_.begin()},i.prototype.initWithUserName_=function(a){this.connection_=new d(a),this.connection_.attachToRunLoop(this.runLoop_);var b=document.getElementById("netsim_lobby_container");this.lobbyControl_=f.createWithin(b,this.connection_),this.lobbyControl_.attachToRunLoop(this.runLoop_);var c=document.getElementById("netsim_tabzone");this.routerPanel_=g.createWithin(c,this.connection_),this.routerPanel_.attachToRunLoop(this.runLoop_)},i.prototype.loadAudio_=function(){},i.prototype.configureDomOverride_=function(a){var b=document.getElementById(a.containerId);b.innerHTML=a.html},i.prototype.onResizeOverride_=function(){var a=document.getElementById("appcontainer"),b=a.parentNode,c=window.getComputedStyle(b),d=parseInt(c.width,10);a.style.top=b.offsetTop+"px",a.style.width=d+"px"}},{"./DashboardUser":111,"./NetSimConnection":112,"./NetSimLobby":115,"./NetSimRouterPanel":121,"./RunLoop":125,"./controls.html":126,"./page.html":130}],130:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push("");{var a=require("../../locale/current/common");require("../../locale/current/netsim")}buf.push('\n\n<div id="rotateContainer" style="background-image: url(',escape(assetUrl("media/mobile_tutorial_turnphone.png")),')">\n  <div id="rotateText">\n    <p>',escape(a.rotateText()),"<br>",escape(a.orientationLock()),"</p>\n  </div>\n</div>\n\n");var b=function(){buf.push('  <div id="bubble" class="clearfix">\n    <table id="prompt-table">\n      <tr>\n        <td id="prompt-icon-cell">\n          <img id="prompt-icon"/>\n        </td>\n        <td id="prompt-cell">\n          <p id="prompt">\n          </p>\n        </td>\n      </tr>\n    </table>\n    <div id="ani-gif-preview-wrapper">\n      <div id="ani-gif-preview">\n        <img id="play-button" src="',escape(assetUrl("media/play-circle.png")),'"/>\n      </div>\n    </div>\n  </div>\n')};buf.push("\n");var c=function(a){buf.push("  "),a&&buf.push('    <div id="helpArea">\n      ',a,"\n    </div>\n  "),buf.push("")};buf.push('\n<div id="appcontainer">\n  <div id="netsim">\n    <div id="netsim_leftcol">\n      <div id="netsim_lobby_container"></div>\n      <hr />\n      <div id="netsim_received"></div>\n      <div id="netsim_sent"></div>\n      <div id="netsim_send"></div>\n    </div>\n    <div id="netsim_rightcol">\n      <div id="netsim_vizualization"></div>\n      <div id="netsim_tabzone"></div>\n    </div>\n  </div>\n  <div id="footers" dir="',escape(data.localeDirection),'">\n    '),b(),buf.push("\n    "),c(data.helpHtml),buf.push('\n  </div>\n</div>\n\n<div class="clear"></div>\n')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{"../../locale/current/common":180,"../../locale/current/netsim":185,ejs:196}],127:[function(a,b){var c=(a("../../locale/current/netsim"),b.exports={});c.netsim_demo={freePlay:!0}},{"../../locale/current/netsim":185}],185:[function(a,b){b.exports=window.blockly.appLocale},{}],126:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div id="slider-cell">\n  <img id="spinner" style="visibility: hidden;" src="',escape(assetUrl("media/turtle/loading.gif")),'" height=15 width=15>\n</div>\n')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:196}],125:[function(a,b){"use strict";var c=a("./ObservableEvent"),d=window.performance&&window.performance.now?window.performance.now.bind(window.performance):Date.now,e=30,f=1e3/e,g=function(){this.enabled=!1,this.clock=new g.Clock,this.tick_=this.buildTickMethod_(),this.tick=new c,this.render=new c};b.exports=g,g.Clock=function(){this.time=d(),this.deltaTime=0},g.prototype.buildTickMethod_=function(){var a,b=this;return a=window.requestAnimationFrame?function(c){b.enabled&&(b.clock.deltaTime=c-b.clock.time,b.clock.time=c,b.tick.notifyObservers(b.clock),b.render.notifyObservers(b.clock),requestAnimationFrame(a))}:function(){if(b.enabled){var c=d();b.clock.deltaTime=c-b.clock.time,b.clock.time=c,b.tick.notifyObservers(b.clock),b.render.notifyObservers(b.clock),setTimeout(a,f-b.clock.deltaTime)}}},g.prototype.begin=function(){this.enabled=!0,this.clock.time=d(),this.tick_(this.clock.time)},g.prototype.end=function(){this.enabled=!1}},{"./ObservableEvent":124}],121:[function(a,b){"use strict";var c=a("./NetSimRouterPanel.html"),d=a("./periodicAction"),e=5e3,f=function(a){this.connection_=a,this.connection_.statusChanges.register(this,this.onConnectionStatusChange_),this.periodicRefresh_=d(this.refresh.bind(this),e),this.myConnectedRouter=void 0};b.exports=f,f.createWithin=function(a,b){var d=new f(b);return a.innerHTML=c({}),d.bindElements_(),d.refresh(),d},f.prototype.bindElements_=function(){this.rootDiv_=$("#netsim_router_panel"),this.connectedSpan_=this.rootDiv_.find("#connected"),this.notConnectedSpan_=this.rootDiv_.find("#not_connected"),this.networkTable_=this.rootDiv_.find("#netsim_router_network_table")},f.prototype.attachToRunLoop=function(a){this.periodicRefresh_.attachToRunLoop(a)},f.prototype.onConnectionStatusChange_=function(){this.connection_.isConnectedToRouter()?this.connection_.myNode.myRouter!==this.myConnectedRouter&&(this.myConnectedRouter=this.connection_.myNode.myRouter,this.periodicRefresh_.enable()):(this.myConnectedRouter=void 0,this.refresh(),this.periodicRefresh_.disable())},f.prototype.refresh=function(){if(this.myConnectedRouter){this.connectedSpan_.show(),this.notConnectedSpan_.hide();var a=this;this.myConnectedRouter.getAddressTable(function(b){a.networkTable_.empty(),$("<tr><th>Hostname</th><th>Address</th></tr>").appendTo(a.networkTable_),b.forEach(function(b){$("<tr><td>"+b.hostname+"</td><td>"+b.address+"</td></tr>").appendTo(a.networkTable_)})})}else this.notConnectedSpan_.show(),this.connectedSpan_.hide()}},{"./NetSimRouterPanel.html":120,"./periodicAction":131}],120:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div id="netsim_router_panel">\n  <span id="not_connected">No router connected.</span>\n  <span id="connected">\n    <h1>My network</h1>\n    <table id="netsim_router_network_table">\n      <tr>\n        <th>Name</th>\n        <th>Address</th>\n      </tr>\n    </table>\n  </span>\n</div>')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:196}],115:[function(a,b){"use strict";var c=a("../dom"),d=a("./NetSimNodeClient"),e=a("./NetSimNodeRouter"),f=a("./NetSimLobby.html"),g=a("./periodicAction"),h=5e3,i=3e4,j=function(a){this.connection_=a,this.connection_.statusChanges.register(this,this.refreshLobby_),this.periodicRefresh_=g(this.refreshLobby_.bind(this),h),this.selectedID_=void 0,this.selectedListItem_=void 0};b.exports=j,j.createWithin=function(a,b){var c=new j(b);return a.innerHTML=f({}),c.bindElements_(),c.refreshShardList_(),c},j.prototype.bindElements_=function(){this.lobbyOpenDiv_=document.getElementById("netsim_lobby_open"),this.lobbyClosedDiv_=document.getElementById("netsim_lobby_closed"),this.shardSelector_=document.getElementById("netsim_shard_select"),$(this.shardSelector_).change(this.onShardSelectorChange_.bind(this)),this.lobbyList_=document.getElementById("netsim_lobby_list"),this.addRouterButton_=document.getElementById("netsim_lobby_add_router"),c.addClickTouchEvent(this.addRouterButton_,this.addRouterButtonClick_.bind(this)),this.connectButton_=document.getElementById("netsim_lobby_connect"),c.addClickTouchEvent(this.connectButton_,this.connectButtonClick_.bind(this)),this.disconnectButton_=document.getElementById("netsim_lobby_disconnect"),c.addClickTouchEvent(this.disconnectButton_,this.disconnectButtonClick_.bind(this)),this.connectionStatusSpan_=document.getElementById("netsim_lobby_statusbar"),this.refreshLobby_()},j.prototype.attachToRunLoop=function(a){this.periodicRefresh_.attachToRunLoop(a)},j.prototype.onShardSelectorChange_=function(){this.connection_.isConnectedToShard()&&(this.connection_.disconnectFromShard(),this.periodicRefresh_.disable()),"__none"!==this.shardSelector_.value&&this.connection_.connectToShard(this.shardSelector_.value)},j.prototype.addRouterButtonClick_=function(){this.connection_.addRouterToLobby()},j.prototype.connectButtonClick_=function(){this.selectedID_&&this.connection_.connectToRouter(this.selectedID_)},j.prototype.disconnectButtonClick_=function(){this.connection_.disconnectFromRouter()},j.prototype.refreshShardList_=function(){var a=this,b="demo",c=this.shardSelector_;this.getUserSections_(function(d){return $(c).empty(),0===d.length?void $("<option>").val("__none").html("-- NONE FOUND --").appendTo(c):($("<option>").val("__none").html("-- PICK ONE --").appendTo(c),d.forEach(function(a){$("<option>").val("netsim_"+b+"_"+a.id).html(a.name).appendTo(c)}),void a.onShardSelectorChange_())})},j.prototype.refreshLobby_=function(){var a=this,b=this.lobbyList_,d=this.connection_.isConnectedToShard(),f=!this.connection_.isConnectedToRouter();if(d?$(this.addRouterButton_).show():(this.shardSelector_.value="__none",$(this.addRouterButton_).hide()),this.periodicRefresh_.setActionInterval(f?h:i),f){if($(this.lobbyOpenDiv_).show(),$(this.lobbyClosedDiv_).hide(),!this.connection_.isConnectedToShard())return $(b).empty(),void $(this.connectButton_).hide();this.connection_.getAllNodes(function(d){$(b).empty(),$(a.connectButton_).show(),d.sort(function(a,b){return a.getDisplayName()>b.getDisplayName()?1:-1}),a.selectedListItem_=void 0,d.forEach(function(d){var f=$("<li>").html(d.getDisplayName()+" : "+d.getStatus()+" "+d.getStatusDetail());d.getNodeType()===e.getNodeType()?f.addClass("router_row"):(f.addClass("user_row"),d.entityID===a.connection_.myNode.entityID&&f.addClass("own_row")),d.entityID===a.selectedID_&&(f.addClass("selected_row"),a.selectedListItem_=f),c.addClickTouchEvent(f[0],a.onRowClick_.bind(a,f,d)),f.appendTo(b)}),a.onSelectionChange(),a.periodicRefresh_.enable()})}else $(this.lobbyClosedDiv_).show(),$(this.lobbyOpenDiv_).hide(),$(this.connectionStatusSpan_).html(this.connection_.myNode.getStatus()+" "+this.connection_.myNode.getStatusDetail())},j.prototype.onRowClick_=function(a,b){if(d.getNodeType()!==b.getNodeType()){var c=this.selectedID_,e=this.selectedListItem_;e&&e.removeClass("selected_row"),this.selectedID_=void 0,this.selectedListItem_=void 0,b.entityID!==c&&(this.selectedID_=b.entityID,this.selectedListItem_=a,this.selectedListItem_.addClass("selected_row")),this.onSelectionChange()}},j.prototype.onSelectionChange=function(){this.connectButton_.disabled=void 0===this.selectedListItem_},j.prototype.getUserSections_=function(a){$.ajax({dataType:"json",url:"/v2/sections/membership",success:a})}},{"../dom":44,"./NetSimLobby.html":114,"./NetSimNodeClient":118,"./NetSimNodeRouter":119,"./periodicAction":131}],114:[function(require,module,exports){module.exports=function(){var t=function anonymous(locals,filters,escape){escape=escape||function(a){return String(a).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var buf=[];with(locals||{})!function(){buf.push('<div id="netsim_lobby_open">\n  <label for="netsim_shard_select">My Section:</label>\n  <select id="netsim_shard_select">\n    <option selected value="__none">Loading...</option>\n  </select>\n  <input type="button" id="netsim_lobby_add_router" value="Add Router" />\n  <ul id="netsim_lobby_list"></ul>\n  <input type="button" id="netsim_lobby_connect" value="Connect" />\n</div>\n<div id="netsim_lobby_closed">\n    <span id="netsim_lobby_statusbar">...</span>\n    <input type="button" id="netsim_lobby_disconnect" value="Disconnect" />\n</div>\n')}();return buf.join("")};return function(a){return t(a,require("ejs").filters)}}()},{ejs:196}],112:[function(a,b){"use strict";var c=a("./NetSimLogger"),d=a("./NetSimNodeClient"),e=a("./NetSimNodeRouter"),f=a("./NetSimWire"),g=a("./ObservableEvent"),h=a("./periodicAction"),i=a("./NetSimShard"),j=new c(c.LogLevel.VERBOSE),k=1e4,l=function(a){this.displayName_=a,this.shard_=null,this.myNode=null,this.statusChanges=new g,this.periodicCleanUp_=h(this.cleanLobby_.bind(this),k),window.addEventListener("beforeunload",this.onBeforeUnload_.bind(this))};b.exports=l,l.prototype.attachToRunLoop=function(a){this.periodicCleanUp_.attachToRunLoop(a),this.periodicCleanUp_.enable(),a.tick.register(this,this.tick)},l.prototype.tick=function(a){this.myNode&&this.myNode.tick(a)},l.prototype.getLogger=function(){return j},l.prototype.onBeforeUnload_=function(){this.isConnectedToShard()&&this.disconnectFromShard()},l.prototype.connectToShard=function(a){this.isConnectedToShard()&&(j.warn("Auto-closing previous connection..."),this.disconnectFromShard()),this.shard_=new i(a),this.createMyClientNode_()},l.prototype.disconnectFromShard=function(){if(!this.isConnectedToShard())return void j.warn("Redundant disconnect call.");this.isConnectedToRouter()&&this.disconnectFromRouter();var a=this;this.myNode.destroy(function(){a.myNode=null,a.statusChanges.notifyObservers()})},l.prototype.createMyClientNode_=function(){var a=this;d.create(this.shard_,function(b){b?(a.myNode=b,a.myNode.onChange.register(a,a.onMyNodeChange_),a.myNode.setDisplayName(a.displayName_),a.myNode.update(function(){a.statusChanges.notifyObservers()})):j.error("Failed to create client node.")})},l.prototype.onMyNodeChange_=function(){"Offline"===this.myNode.getStatus()&&this.disconnectFromShard()},l.prototype.isConnectedToShard=function(){return null!==this.myNode},l.prototype.getAllNodes=function(a){if(!this.isConnectedToShard())return j.warn("Can't get lobby rows, not connected to shard."),void a([]);var b=this;this.shard_.lobbyTable.readAll(function(c){if(!c)return j.warn("Lobby data request failed, using empty list."),void a([]);var f=c.map(function(a){return a.type===d.getNodeType()?new d(b.shard_,a):a.type===e.getNodeType()?new e(b.shard_,a):void 0}).filter(function(a){return void 0!==a});a(f)})},l.prototype.cleanLobby_=function(){if(this.shard_){var a=this;this.getAllNodes(function(a){a.forEach(function(a){a.isExpired()&&a.destroy()})}),this.shard_.wireTable.readAll(function(b){b&&b.map(function(b){return new f(a.shard_,b)}).forEach(function(a){a.isExpired()&&a.destroy()})})}},l.prototype.addRouterToLobby=function(){var a=this;e.create(this.shard_,function(){a.statusChanges.notifyObservers()})},l.prototype.isConnectedToRouter=function(){return this.myNode&&this.myNode.myRouter},l.prototype.connectToRouter=function(a){this.isConnectedToRouter()&&(j.warn("Auto-disconnecting from previous router."),this.disconnectFromRouter());var b=this;e.get(a,this.shard_,function(c){return c?void b.myNode.connectToRouter(c,function(a){a||j.warn("Failed to connect to "+c.getDisplayName()),b.statusChanges.notifyObservers()}):void j.warn("Failed to find router with ID "+a)})},l.prototype.disconnectFromRouter=function(){if(!this.isConnectedToRouter())return void j.warn("Cannot disconnect: Not connected.");var a=this;this.myNode.disconnectRemote(function(){a.statusChanges.notifyObservers()})}},{"./NetSimLogger":116,"./NetSimNodeClient":118,"./NetSimNodeRouter":119,"./NetSimShard":122,"./NetSimWire":123,"./ObservableEvent":124,"./periodicAction":131}],131:[function(a,b){"use strict";var c=function(a,b){var c=1/0,d=b;return{attachToRunLoop:function(a){a.tick.register(this,this.tick)},tick:function(b){if(b.time>=c)if(a(b),0===c)c=b.time+d;else for(;c<b.time;)c+=d},enable:function(){1/0===c&&(c=0)},disable:function(){c=1/0},isEnabled:function(){return 1/0!==c},setActionInterval:function(a){d=a}}};b.exports=c},{}],122:[function(a,b){"use strict";var c=a("../appsApi").SharedTable,d="localhost"===window.location.hostname.split(".")[0]?"JGW2rHUp_UCMW_fQmRf6iQ==":"HQJ8GCCMGP7Yh8MrtDusIA==",e=function(a){this.shardID=a,this.lobbyTable=new c(d,a+"_node"),this.wireTable=new c(d,a+"_wire")};b.exports=e},{"../appsApi":16}],119:[function(a,b){"use strict";var c=a("./NetSimNode"),d=a("./NetSimEntity"),e=a("./NetSimWire"),f=function(a,b){c.call(this,a,b),this.MAX_CLIENT_CONNECTIONS=6};f.prototype=Object.create(c.prototype),f.prototype.constructor=f,b.exports=f,f.create=function(a,b){d.create(f,a,function(a){a?a.update(function(){b(a)}):b(a)})},f.get=function(a,b,c){d.get(f,a,b,c)},f.RouterStatus={INITIALIZING:"Initializing",READY:"Ready",FULL:"Full"};var g=f.RouterStatus;f.prototype.update=function(a){a=a||function(){};var b=this;this.countConnections(function(d){b.status_=d>=b.MAX_CLIENT_CONNECTIONS?g.FULL:g.READY,b.statusDetail_="("+d+"/"+b.MAX_CLIENT_CONNECTIONS+")",c.prototype.update.call(b,a)})},f.prototype.getDisplayName=function(){return"Router "+this.entityID},f.prototype.getNodeType=function(){return f.getNodeType()},f.getNodeType=function(){return"router"},f.prototype.getWireTable=function(){return this.shard_.wireTable},f.prototype.getConnections=function(a){a=a||function(){};var b=this.shard_,c=this.entityID;this.shard_.wireTable.readAll(function(d){if(null===d)return void a([]);var f=d.map(function(a){return new e(b,a)}).filter(function(a){return a.remoteNodeID===c});a(f)})},f.prototype.countConnections=function(a){a=a||function(){},this.getConnections(function(b){a(b.length)})};var h=function(a,b){return a.some(function(a){return a===b})};f.prototype.acceptConnection=function(a,b){var c=this;this.countConnections(function(a){return a>c.MAX_CLIENT_CONNECTIONS?void b(!1):void b(!0)})},f.prototype.requestAddress=function(a,b,c){c=c||function(){};var d=this;this.getConnections(function(e){for(var f=e.filter(function(a){return void 0!==a.localAddress}).map(function(a){return a.localAddress}),g=1;h(f,g);)g++;a.localAddress=g,a.localHostname=b,a.remoteAddress=0,a.remoteHostname=d.getHostname(),a.update(c)})},f.prototype.getAddressTable=function(a){a=a||function(){};var b=this;this.getConnections(function(c){var d=c.map(function(a){return{hostname:a.localHostname,address:a.localAddress}}).concat({hostname:b.getHostname(),address:0});a(d)})}},{"./NetSimEntity":113,"./NetSimNode":117,"./NetSimWire":123}],118:[function(a,b){"use strict";var c=a("./NetSimNode"),d=a("./NetSimEntity"),e=function(a,b){c.call(this,a,b),this.ENTITY_TIMEOUT_MS=3e4,this.ENTITY_KEEPALIVE_MS=2e3,this.myWire=null,this.myRouter=null};e.prototype=Object.create(c.prototype),e.prototype.constructor=e,b.exports=e,e.create=function(a,b){d.create(e,a,b)},e.prototype.getNodeType=function(){return e.getNodeType()},e.getNodeType=function(){return"user"},e.prototype.getStatus=function(){return this.status_?this.status_:"Online"},e.prototype.setDisplayName=function(a){this.displayName_=a},e.prototype.tick=function(a){c.prototype.tick.call(this,a),this.myWire&&this.myWire.tick(a),this.myRouter&&this.myRouter.tick(a)},e.prototype.update=function(a,b){a||(a=function(){}),void 0===b&&(b=!0);var d=this;c.prototype.update.call(this,function(c){!c&&b?d.reconnect_(function(b){b||(d.status_="Offline",d.onChange.notifyObservers()),a(b)}):a(c)})},e.prototype.reconnect_=function(a){var b=this;e.create(this.shard_,function(c){return c?(b.entityID=c.entityID,void b.update(function(c){return c?void(null!==b.myWire?(b.myWire.localNodeID=b.entityID,b.myWire.update(function(b){return b?void a(!0):void a(!1)})):a(!0)):void a(!1)},!1)):void a(!1)})},e.prototype.connectToRouter=function(a,b){b||(b=function(){});var c=this;this.connectToNode(a,function(d){return d?(c.myWire=d,c.myRouter=a,void a.requestAddress(d,c.getHostname(),function(e){return e?(c.myWire=d,c.myRouter=a,void c.myRouter.update(b)):void d.destroy(function(){b(!1)})})):void b(!1)})},e.prototype.disconnectRemote=function(a){a||(a=function(){});var b=this;this.myWire.destroy(function(c){return c?(b.myWire=null,b.myRouter.update(a),void(b.myRouter=null)):void a(c)})}},{"./NetSimEntity":113,"./NetSimNode":117}],117:[function(a,b){"use strict";var c=a("./NetSimEntity"),d=a("./NetSimWire"),e=function(a,b){c.call(this,a,b),void 0===b&&(b={}),this.displayName_=b.name,this.status_=b.status,this.statusDetail_=b.statusDetail};e.prototype=Object.create(c.prototype),e.prototype.constructor=e,b.exports=e,e.prototype.getTable_=function(){return this.shard_.lobbyTable},e.prototype.buildRow_=function(){return $.extend(c.prototype.buildRow_.call(this),{name:this.getDisplayName(),type:this.getNodeType(),status:this.getStatus(),statusDetail:this.getStatusDetail()})},e.prototype.getDisplayName=function(){return this.displayName_?this.displayName_:"[New Node]"},e.prototype.getHostname=function(){return this.getDisplayName().replace(/[^\w\d]/g,"").toLowerCase()},e.prototype.getNodeType=function(){throw new Error("getNodeType method is not implemented")},e.prototype.getStatus=function(){return this.status_},e.prototype.getStatusDetail=function(){return this.statusDetail_?this.statusDetail_:""},e.prototype.connectToNode=function(a,b){b||(b=function(){});var c=this;d.create(this.shard_,function(d){return null===d?void b(null):(d.localNodeID=c.entityID,d.remoteNodeID=a.entityID,void d.update(function(e){return e?void a.acceptConnection(c,function(a){return a?void b(d):void d.destroy(function(){b(null)})}):void d.destroy(function(){b(null)})}))})},e.prototype.acceptConnection=function(a,b){b(!0)}},{"./NetSimEntity":113,"./NetSimWire":123}],123:[function(a,b){"use strict";var c=a("./NetSimEntity"),d=function(a,b){c.call(this,a,b),void 0===b&&(b={}),this.localNodeID=b.localNodeID,this.remoteNodeID=b.remoteNodeID,this.localAddress=b.localAddress,this.remoteAddress=b.remoteAddress,this.localHostname=b.localHostname,this.remoteHostname=b.remoteHostname,this.wireMode=void 0!==b.wireMode?b.wireMode:"duplex"};d.prototype=Object.create(c.prototype),d.prototype.constructor=d,b.exports=d,d.create=function(a,b){c.create(d,a,b)},d.prototype.getTable_=function(){return this.shard_.wireTable},d.prototype.buildRow_=function(){return $.extend(c.prototype.buildRow_.call(this),{localNodeID:this.localNodeID,remoteNodeID:this.remoteNodeID,localAddress:this.localAddress,remoteAddress:this.remoteAddress,localHostname:this.localHostname,remoteHostname:this.remoteHostname,wireMode:this.wireMode})}},{"./NetSimEntity":113}],113:[function(a,b){"use strict";var c=a("./ObservableEvent"),d=function(a,b){void 0===b&&(b={}),this.shard_=a,this.lastPing_=b.lastPing,this.entityID=b.id,this.ENTITY_TIMEOUT_MS=3e5,this.ENTITY_KEEPALIVE_MS=3e4,this.onChange=new c};b.exports=d,d.create=function(a,b,c){c=c||function(){};var d=new a(b);d.getTable_().create(d.buildRow_(),function(d){c(d?new a(b,d):null)})},d.get=function(a,b,c,d){d=d||function(){};var e=new a(c);e.getTable_().read(b,function(b){d(b?new a(c,b):null)})},d.prototype.update=function(a){a=a||function(){},this.lastPing_=Date.now(),this.getTable_().update(this.entityID,this.buildRow_(),a)},d.prototype.destroy=function(a){a=a||function(){},this.getTable_()["delete"](this.entityID,a)},d.prototype.getTable_=function(){throw new Error("Method getTable_ is not implemented.")},d.prototype.buildRow_=function(){return{lastPing:Date.now()}},d.prototype.isExpired=function(){return Date.now()-this.lastPing_>=this.ENTITY_TIMEOUT_MS},d.prototype.tick=function(){Date.now()-this.lastPing_>=this.ENTITY_KEEPALIVE_MS&&this.update()}},{"./ObservableEvent":124}],124:[function(a,b){"use strict";var c=function(){this.observerList_=[]};b.exports=c,c.prototype.register=function(a,b){var c={thisArg:a,toCall:b};return Object.freeze(c),this.observerList_.push(c),c},c.prototype.unregister=function(a){for(var b=0;b<this.observerList_.length;b++)if(a===this.observerList_[b])return this.observerList_.splice(b,1),!0;return!1},c.prototype.notifyObservers=function(){var a=Array.prototype.slice.call(arguments,0);this.observerList_.forEach(function(b){b.toCall.apply(b.thisArg,a)})}},{}],116:[function(a,b){"use strict";var c=function(a,b){this.outputConsole_=a,this.log_=function(){},this.info=function(){},this.warn=function(){},this.error=function(){},this.initializeWithVerbosity_(void 0===b?d.VERBOSE:b)};b.exports=c;var d={NONE:0,ERROR:1,WARN:2,INFO:3,VERBOSE:4};c.LogLevel=d,c.prototype.initializeWithVerbosity_=function(a){this.log_=this.outputConsole_&&this.outputConsole_.log?this.outputConsole_.log.bind(this.outputConsole_):function(){},this.info=a>=d.INFO?this.outputConsole_&&this.outputConsole_.info?this.outputConsole_.info.bind(this.outputConsole_):this.log_:function(){},this.warn=a>=d.WARN?this.outputConsole_&&this.outputConsole_.warn?this.outputConsole_.warn.bind(this.outputConsole_):this.log_:function(){},this.error=a>=d.ERROR?this.outputConsole_&&this.outputConsole_.error?this.outputConsole_.error.bind(this.outputConsole_):this.log_:function(){}},c.prototype.log=function(a,b){switch(void 0===b&&(b=d.INFO),b){case d.ERROR:this.error(a);break;case d.WARN:this.warn(a);break;case d.INFO:this.info(a);break;default:this.log_(a)}}},{}],111:[function(a,b){"use strict";var c=function(){this.isReady=!1,this.whenReadyCallbacks_=[],this.id=void 0,this.name=""};b.exports=c,c.currentUser_=null,c.getCurrentUser=function(){return c.currentUser_||(c.currentUser_=new c,$.ajax({url:"/v2/user",type:"get",dataType:"json",success:function(a){c.currentUser_.initialize_(a)},error:function(){throw new Error("Unable to retrieve current user info.")}})),c.currentUser_},c.prototype.initialize_=function(a){this.id=a.id,this.name=a.name,this.isReady=!0,this.whenReadyCallbacks_.forEach(function(a){a(this)}.bind(this)),this.whenReadyCallbacks_=[]},c.prototype.whenReady=function(a){this.isReady?a(this):this.whenReadyCallbacks_.push(a)}},{}],16:[function(a,b){"use strict";var c=b.exports,d=function(a){this.apiBaseUrl_=a};d.prototype.get=function(a,b,c){$.ajax({url:this.apiBaseUrl_+a,type:"get",dataType:"json"}).done(function(a){b(a)}).fail(function(){b(c)})},d.prototype.post=function(a,b,c){$.ajax({url:this.apiBaseUrl_+a,type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify(b)}).done(function(){c(!0)}).fail(function(){c(!1)})},d.prototype.postToGet=function(a,b,c,d){$.ajax({url:this.apiBaseUrl_+a,type:"post",contentType:"application/json; charset=utf-8",data:JSON.stringify(b)}).done(function(a){c(a)}).fail(function(){c(d)})},d.prototype["delete"]=function(a,b){$.ajax({url:this.apiBaseUrl_+a,type:"delete"}).done(function(){b(!0)}).fail(function(){b(!1)})},c.AppsTable=function(){this.requestHelper_=new d("/v3/apps")},c.AppsTable.prototype.readAll=function(a){this.requestHelper_.get("",a,null)},c.AppsTable.prototype.read=function(a,b){this.requestHelper_.get("/"+a,b,void 0)},c.AppsTable.prototype.create=function(a,b){this.requestHelper_.postToGet("",a,b,void 0)},c.AppsTable.prototype.update=function(a,b,c){this.requestHelper_.post("/"+a,b,c)},c.AppsTable.prototype["delete"]=function(a,b){this.requestHelper_["delete"]("/"+a,b)},c.SharedTable=function(a,b){c.AppsTable.call(this),this.requestHelper_=new d("/v3/apps/"+a+"/shared-tables/"+b)},c.SharedTable.prototype=Object.create(c.AppsTable.prototype),c.SharedTable.prototype.constructor=c.SharedTable,c.UserTable=function(a,b){c.AppsTable.call(this),this.requestHelper_=new d("/v3/apps/"+a+"/user-tables/"+b)},c.UserTable.prototype=Object.create(c.AppsTable.prototype),c.UserTable.prototype.constructor=c.UserTable,c.PropertyBag=function(a){this.requestHelper_=new d("/v3/apps"+a+"/shared-properties")},c.PropertyBag.prototype.readAll=function(a){this.requestHelper_.get("",a,null)},c.PropertyBag.prototype.read=function(a,b){this.requestHelper_.get("/"+a,b,void 0)},c.PropertyBag.prototype.set=function(a,b,c){this.requestHelper_.post("/"+a,b,c)},c.PropertyBag.prototype["delete"]=function(a,b){this.requestHelper_["delete"]("/"+a,b)},c.UserPropertyBag=function(a){c.PropertyBag.call(this,a),this.requestHelper_=new d("/v3/apps/"+a+"/user-properties")},c.UserPropertyBag.prototype=Object.create(c.PropertyBag.prototype),c.UserPropertyBag.prototype.constructor=c.UserPropertyBag},{}]},{},[128]);